<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>備品登録一覧画面</title>
    <link rel="stylesheet" href="../../static/css/style.css">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" th:href="@{/webjars/bootstrap/3.3.7/css/bootstrap.min.css}" />
</head>
<body>
    <p>
        <span sec:authentication="principal.user.username">duke</span>さんログイン中。
    </p>
    <form th:action="@{/logout}" method="post"><input type="submit" class="btn btn-default btn-xs" value="ログアウト" /></form>

    <form th:action="@{/tools/create}" th:object="${toolForm}" method="post">
        <table class="table table-striped talbe-bordered table-condensed">
            <tr>
                <td>管理コード:</td>
                <td>
                <select name="managementcode" th:field="*{managementcode}" th:errorclass="error-input">
                    <option value="">選択してください</option> <!-- 初期の選択肢 -->
                    <option value="1">マウス</option> <!-- 管理番号の候補1 -->
                    <option value="2">キーボード</option> <!-- 管理番号の候補2 -->
                    <option value="3">モニター</option> <!-- 管理番号の候補3 -->
                    <option value="4">プリンター</option> <!-- 管理番号の候補4 -->
                    <option value="5">スキャナー</option> <!-- 管理番号の候補5 -->
                    <option value="6">サーバー</option> <!-- 管理番号の候補6 -->
                    <option value="7">外付けハードドライブ</option> <!-- 管理番号の候補7 -->
                    <option value="8">USBハブ</option> <!-- 管理番号の候補8 -->
                    <option value="9">webカメラ</option> <!-- 管理番号の候補9 -->
                    <option value="10">ヘッドセット</option> <!-- 管理番号の候補10 -->
                    <option value="11">ドッキングステーション</option> <!-- 管理番号の候補11 -->
                    <option value="12">リーダー/ライター</option> <!-- 管理番号の候補12 -->
                    <option value="13">電源タップ</option> <!-- 管理番号の候補13 -->
                    <option value="14">モニターアーム</option> <!-- 管理番号の候補14 -->
                    <option value="15">マウスパッド</option> <!-- 管理番号の候補15 -->
                    <option value="16">ケーブル管理ツール</option> <!-- 管理番号の候補16 -->
                    <option value="17">ソフトウェアⅠ</option> <!-- 管理番号の候補17 -->
                    <option value="18">ソフトウェアⅡ</option> <!-- 管理番号の候補18 -->

                    <!-- 必要に応じて他の管理番号の候補を追加 -->
                </select>
                <span th:if="${#fields.hasErrors('managementcode')}" th:errors="*{managementcode}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>管理番号:</td>
                <td>
                    <input type="text" name="managementNo" th:field="*{managementNo}" th:errorclass="error-input" />
                    <span th:if="${#fields.hasErrors('managementNo')}" th:errors="*{managementNo}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>品名:</td>
                <td>
                    <input type="text" name="productName" th:field="*{productName}" th:errorclass="error-input" />
                    <span th:if="${#fields.hasErrors('productName')}" th:errors="*{productName}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>型番:</td>
                <td>
                    <input type="text" name="modelNumber" th:field="*{modelNumber}" th:errorclass="error-input" />
                    <span th:if="${#fields.hasErrors('modelNumber')}" th:errors="*{modelNumber}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>メーカー:</td>
                <td>
                    <input type="text" name="maker" th:field="*{maker}" th:errorclass="error-input" />
                    <span th:if="${#fields.hasErrors('maker')}" th:errors="*{maker}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>購入日:</td>
                <td>
                    <input type="text" name="purchaseDate" th:field="*{purchaseDate}" th:errorclass="error-input" />
                    <span th:if="${#fields.hasErrors('purchaseDate')}" th:errors="*{purchaseDate}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>耐用年数:</td>
                <td>
                    <select name="serviceLife" th:field="*{serviceLife}" th:errorclass="error-input">
                        <option value="">機器の種類を選択してください</option> <!-- 初期の選択肢 -->
                        <option value="1">PC</option> <!-- 耐用年数の候補1 -->
                        <option value="2">PC以外の電子計算機</option> <!-- 耐用年数の候補2 -->
                        <option value="3">レジスター</option> <!-- 耐用年数の候補3 -->
                        <option value="4">プリンター、ファクシミリ</option> <!-- 管理番号の候補4 -->
                        <option value="5">ソフトウェア（3年）</option> <!-- 耐用年数の候補5 -->
                        <option value="6">ソフトウェア（5年）</option> <!-- 耐用年数の候補6 -->
                    </select>
                    <span th:if="${#fields.hasErrors('serviceLife')}" th:errors="*{serviceLife}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>減価償却:</td>
                <td>
                    <input type="text" name="depreciation" th:field="*{depreciation}" th:errorclass="error-input" />
                    <span th:if="${#fields.hasErrors('depreciation')}" th:errors="*{depreciation}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>使用不可:</td>
                <td>
                    <label><input type="radio" name="usageProhibited" th:field="*{usageProhibited}" th:errorclass="error-input" /> 不可</label>
                    <label><input type="radio" name="usageProhibited" th:field="*{usageProhibited}" th:errorclass="error-input" /> 可能</label>
                    <span th:if="${#fields.hasErrors('usageProhibited')}" th:errors="*{usageProhibited}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>貸出可能:</td>
                <td>
                    <label><input type="radio" name="avaliableForRent" th:field="*{avaliableForRent}" th:errorclass="error-input" />不可</label>
                    <label><input type="radio" name="avaliableForRent" th:field="*{avaliableForRent}" th:errorclass="error-input" />可能</label>
                    <span th:if="${#fields.hasErrors('avaliableForRent')}" th:errors="*{avaliableForRent}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>設置場所:</td>
                <td>
                    <label><input type="checkbox" name="installationLocation" value="0" th:field="*{installationLocation}" th:errorclass="error-input" />本社</label>
                    <label><input type="checkbox" name="installationLocation" value="1" th:field="*{installationLocation}" th:errorclass="error-input" />仙台</label>
                    <label><input type="checkbox" name="installationLocation" value="2" th:field="*{installationLocation}" th:errorclass="error-input" />埼玉</label>
                    <label><input type="checkbox" name="installationLocation" value="3" th:field="*{installationLocation}" th:errorclass="error-input" />新潟</label>
                    <label><input type="checkbox" name="installationLocation" value="4" th:field="*{installationLocation}" th:errorclass="error-input" />大阪</label>
                    <span th:if="${#fields.hasErrors('installationLocation')}" th:errors="*{installationLocation}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>使用期限:</td>
                <td>
                    <input type="text" name="exprationDate" th:field="*{exprationDate}" th:errorclass="error-input" />
                    <span th:if="${#fields.hasErrors('exprationDate')}" th:errors="*{exprationDate}" class="error-messages">error!</span>
                </td>
            </tr>
            <tr>
                <td>仕様:</td>
                <td>
                    <input type="text" name="specification" th:field="*{specification}" th:errorclass="error-input" />
                    <span th:if="${#fields.hasErrors('specification')}" th:errors="*{specification}" class="error-messages">error!</span>
                </td>
            </tr>
        </table>
        <input type="submit" value="作成">
    </form>
    <hr />
    <table>
        <tr th:each="tool : ${tools}">
            <td th:text="${tool.managementcode}">MC</td>
            <td th:text="${tool.managementNo}">000002</td>
            <td th:text="${tool.productName}">ラックマウントサーバ</td>
            <td th:text="${tool.modelNumber}">PowerEdge R220ラックサーバ</td>
            <td th:text="${tool.maker}">DELL</td>
            <td th:text="${#dates.format(tool.purchaseDate, 'yyyy-MM-dd')}">2016/5/26</td>
            <td th:text="${tool.serviceLife}">5</td>
            <td th:text="${tool.depreciation}">終了</td>
            <td>
                <input type="checkbox" th:checked="${tool.usageProhibited}" disabled> 使用不可
            </td>
            <td>
                <input type="checkbox" th:checked="${tool.availableForRent}" disabled> 可能
            </td>
            <td th:text="${tool.installationLocation}">仙台</td>
            <td th:text="${#dates.format(tool.expirationDate, 'yyyy-MM-dd')}">2019/7/1</td>
            <td th:text="${tool.specification}">インテル🄬 Xeon🄬プロセッサーE3-1200 v3</td>
            <td>
                <form th:action="@{/tools/edit}" method="post">
                    <input type="submit" name="form" value="編集" />
                    <input type="hidden" name="managementNo" th:value="${tool.managementNo}" />
                </form>
            </td>
            <td>
                <form th:action="@{/tools/delete}" method="post">
                    <input type="submit" name="form" value="削除" />
                    <input type="hidden" name="managementNo" th:value="${tool.managementNo}" />
                </form>
            </td>
        </tr>
    </table>

    <h2>備品検索結果</h2>
    
    <form th:action="@{/tools/search}" method="get">
        <label>キーワード:</label>
        <input type="text" name="keyword" />
        <button type="submit">検索</button>
    </form>

    <!-- 検索結果表示 -->
    <table class="table table-striped table-bordered table-condensed">
        <thead>
            <tr>
                <th>管理コード</th>
                <th>品名</th>
                <th>型番</th>
                <th>メーカー</th>
                <th>購入日</th>
                <th>耐用年数</th>
                <th>減価償却</th>
                <th>使用不可</th>
                <th>貸出可能</th>
                <th>設置場所</th>
                <th>使用期限</th>
                <th>仕様</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            <!-- ここにThymeleafを使って検索結果を表示する -->
            <tr th:each="tool : ${tools}">
                <td th:text="${tool.managementcode}"></td>
                <td th:text="${tool.productName}"></td>
                <td th:text="${tool.modelNumber}"></td>
                <td th:text="${tool.maker}"></td>
                <td th:text="${tool.purchaseDate}"></td>
                <td th:text="${tool.serviceLife}"></td>
                <td th:text="${tool.depreciation}"></td>
                <td th:text="${tool.usageProhibited ? '不可' : '可能'}"></td>
                <td th:text="${tool.avaliableForRent ? '可能' : '不可'}"></td>
                <td>
                    <span th:each="location : ${tool.installationLocation}">
                        <span th:text="${location}"></span>
                        <span th:if="${!#strings.endsWith(iterator.index, #numbers.sequence('1', '4'))}">,</span>
                    </span>
                </td>
                <td th:text="${tool.expirationDate}"></td>
                <td th:text="${tool.specification}"></td>
                <td>
                    <form th:action="@{/tools/edit}" method="post">
                        <input type="submit" name="form" value="編集" />
                        <input type="hidden" name="managementNo" th:value="${tool.managementNo}" />
                    </form>
                    <form th:action="@{/tools/delete(param.managementNo=${tool.managementNo})}" method="post">
                        <input type="submit" value="削除" onclick="return confirm('本当に削除しますか？');" />
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
</body>
</html>

